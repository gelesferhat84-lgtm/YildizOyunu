<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Yıldız Oyunu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html,body{
  margin:0;
  padding:0;
  background:#0b0b1a;
  overflow:hidden;
  font-family:Arial,Helvetica,sans-serif;
}
#game{
  position:relative;
  width:100vw;
  height:100vh;
  overflow:hidden;
}
#panel{
  position:absolute;
  bottom:20px;
  width:120px;
  height:25px;
  background:#ff4d6d;
  border-radius:12px;
}
.item{
  position:absolute;
  font-size:32px;
  user-select:none;
}
.meteor{ font-size:34px; }
.heart{ font-size:30px; }
.letter{ font-size:34px; }

#lives{
  position:absolute;
  top:10px;
  left:10px;
  font-size:26px;
}

#boxes{
  position:absolute;
  bottom:60px;
  width:100%;
  display:flex;
  justify-content:center;
  gap:8px;
}
.box{
  width:50px;
  height:50px;
  border:2px dashed #fff;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#fff;
  font-size:28px;
}

#gameOver{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.8);
  display:none;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:#fff;
  z-index:99;
}
#gameOver button{
  padding:12px 25px;
  font-size:18px;
  border:none;
  border-radius:10px;
  background:#ff4d6d;
  color:#fff;
  cursor:pointer;
}
</style>
</head>
<body>

<div id="game">
  <div id="lives">❤️❤️❤️</div>
  <div id="panel"></div>

  <div id="boxes"></div>

  <div id="gameOver">
    <h1>Oyun Bitti</h1>
    <button onclick="restart()">Tekrar Oyna</button>
  </div>
</div>

<script>
const game = document.getElementById("game");
const panel = document.getElementById("panel");
const livesUI = document.getElementById("lives");
const boxesDiv = document.getElementById("boxes");
const gameOverDiv = document.getElementById("gameOver");

let lives = 3;
let panelX = innerWidth/2 - 60;
let items = [];
let letters = ["⭐","⭐","⭐","⭐","⭐","⭐"];
let letterActive = {};
let filledBoxes = {};
let running = true;

panel.style.left = panelX+"px";

/* KUTULAR */
letters.forEach(l=>{
  filledBoxes[l]=false;
  const b=document.createElement("div");
  b.className="box";
  b.dataset.letter=l;
  boxesDiv.appendChild(b);
});

/* PANEL KONTROL */
let dragging=false;
addEventListener("pointerdown",()=>dragging=true);
addEventListener("pointerup",()=>dragging=false);
addEventListener("pointermove",e=>{
  if(!dragging) return;
  panelX = e.clientX - panel.offsetWidth/2;
  panelX = Math.max(0, Math.min(innerWidth-panel.offsetWidth,panelX));
  panel.style.left = panelX+"px";
});

/* METEOR */
function spawnMeteor(){
  const m=document.createElement("div");
  m.className="item meteor";
  m.textContent="☄️";
  m.x=Math.random()*(innerWidth-40);
  m.y=-40;
  m.vy=2+Math.random()*2;
  m.vr=Math.random()*4-2;
  m.r=0;
  game.appendChild(m);
  items.push(m);
}

/* KALP */
function spawnHeart(){
  if(Math.random()>0.005) return;
  const h=document.createElement("div");
  h.className="item heart";
  h.textContent="❤️";
  h.x=Math.random()*(innerWidth-30);
  h.y=-30;
  h.vy=2;
  game.appendChild(h);
  items.push(h);
}

/* HARF */
function spawnLetter(){
  const available = letters.filter(l=>!letterActive[l] && !filledBoxes[l]);
  if(!available.length) return;
  if(Math.random()>0.01) return;

  const ltr = available[Math.floor(Math.random()*available.length)];
  letterActive[ltr]=true;

  const l=document.createElement("div");
  l.className="item letter";
  l.textContent=ltr;
  l.letter=ltr;
  l.x=Math.random()*(innerWidth-30);
  l.y=-30;
  l.vy=2;
  game.appendChild(l);
  items.push(l);
}

/* ÇARPIŞMA */
function hit(a,b){
  return a.x < b.x + b.offsetWidth &&
         a.x + a.offsetWidth > b.x &&
         a.y < b.y + b.offsetHeight &&
         a.y + a.offsetHeight > b.y;
}

/* OYUN DÖNGÜ */
function loop(){
  if(!running) return;

  spawnHeart();
  spawnLetter();

  items.forEach((it,i)=>{
    it.y += it.vy || 2;
    it.style.top=it.y+"px";
    it.style.left=it.x+"px";

    if(it.classList.contains("meteor")){
      it.r += it.vr;
      it.style.transform=`rotate(${it.r}deg)`;
      if(hit(it,panel)){
        lives--;
        updateLives();
        it.remove();
        items.splice(i,1);
        spawnMeteor();
        if(lives<=0) endGame();
      }
      if(it.y>innerHeight){ it.remove(); items.splice(i,1); spawnMeteor(); }
    }

    if(it.classList.contains("heart")){
      if(hit(it,panel)){
        lives=Math.min(3,lives+1);
        updateLives();
        it.remove(); items.splice(i,1);
      }
      if(it.y>innerHeight){ it.remove(); items.splice(i,1); }
    }

    if(it.classList.contains("letter")){
      if(hit(it,panel)){
        fillBox(it.letter);
        letterActive[it.letter]=false;
        it.remove(); items.splice(i,1);
      }
      if(it.y>innerHeight){
        letterActive[it.letter]=false;
        it.remove(); items.splice(i,1);
      }
    }
  });

  requestAnimationFrame(loop);
}

/* CAN */
function updateLives(){
  livesUI.textContent="❤️".repeat(lives);
}

/* KUTU DOLDUR */
function fillBox(letter){
  const box=[...document.querySelectorAll(".box")]
    .find(b=>b.dataset.letter===letter && b.textContent==="");
  if(box){
    box.textContent=letter;
    filledBoxes[letter]=true;
  }
}

/* OYUN BİT */
function endGame(){
  running=false;
  gameOverDiv.style.display="flex";
}

/* YENİDEN */
function restart(){
  location.reload();
}

/* BAŞLAT */
for(let i=0;i<6;i++) spawnMeteor();
loop();
</script>
</body>
</html>
