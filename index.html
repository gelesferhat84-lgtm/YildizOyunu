<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>YILDIZ</title>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:radial-gradient(circle at top,#2b0b4f,#05010a);
  touch-action:none;
}
body::before{
  content:"";
  position:fixed;
  inset:0;
  background-image:
    radial-gradient(1px 1px at 20% 30%,#fff,transparent),
    radial-gradient(1px 1px at 70% 60%,#fff,transparent),
    radial-gradient(1px 1px at 40% 80%,#fff,transparent);
  opacity:.18;
  pointer-events:none;
}

/* HUD */
#hud{
  position:fixed;
  top:14px;
  left:14px;
  color:white;
  font-size:18px;
  z-index:20;
}
#lives{margin-left:6px}
#level{display:block;font-size:14px;opacity:.8}

/* Hik√¢ye */
#storyLine{
  position:fixed;
  top:60px;
  left:50%;
  transform:translateX(-50%);
  color:#ffd1e8;
  font-size:18px;
  text-shadow:0 0 12px rgba(255,150,200,.8);
  opacity:0;
  z-index:25;
  transition:.5s;
}
#storyLine.show{opacity:1}

/* Panel */
#panel{
  position:fixed;
  bottom:80px;
  left:50%;
  transform:translateX(-50%);
  width:60px;
  height:14px;
  border-radius:20px;
  background:linear-gradient(90deg,#ff6aa2,#ff2f7a);
  box-shadow:0 0 30px rgba(255,80,180,.9);
  z-index:15;
}

/* Harf kutularƒ± */
#letterBoxes{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:8px;
  z-index:16;
}
.box{
  width:30px;
  height:30px;
  border-radius:8px;
  background:rgba(255,255,255,.12);
  border:1px solid rgba(255,255,255,.5);
  color:white;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  font-size:15px;
}
.box.filled{
  background:rgba(255,255,255,.3);
  box-shadow:0 0 12px rgba(255,200,220,.9);
}

/* Objeler */
.item{position:absolute;top:-80px;pointer-events:none}
.star{
  width:18px;height:18px;
  background:radial-gradient(circle,#ffe58a,#ffb300);
  clip-path:polygon(50% 0%,61% 35%,98% 35%,68% 57%,79% 91%,50% 70%,21% 91%,32% 57%,2% 35%,39% 35%);
  box-shadow:0 0 12px gold;
}
.heart{
  width:22px;height:22px;
  background:#ff4d6d;
  transform:rotate(-45deg);
  border-radius:50% 50% 0 0;
}
.heart::before,.heart::after{
  content:"";
  position:absolute;
  width:22px;height:22px;
  background:#ff4d6d;
  border-radius:50%;
}
.heart::before{top:-11px}
.heart::after{left:11px}
.meteor{
  width:16px;height:16px;
  border-radius:50%;
  background:radial-gradient(circle,#9e9e9e,#424242);
}
.letter{
  font-size:22px;
  font-weight:bold;
  color:#ffd54f;
  text-shadow:0 0 14px gold;
}

/* Oyun sonu */
#over{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.8);
  color:white;
  z-index:30;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  text-align:center;
}
#over h1{font-size:32px;margin-bottom:10px}
#over button{
  margin-top:15px;
  padding:10px 22px;
  border:none;
  border-radius:14px;
  background:#ff4d6d;
  color:white;
  font-size:18px;
}
</style>
</head>

<body>

<div id="hud">
  Skor: <span id="score">0</span>
  <span id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>
  <span id="level">Level: 1</span>
</div>

<div id="storyLine"></div>
<div id="letterBoxes"></div>
<div id="panel"></div>

<div id="over">
  <h1 id="endText"></h1>
  <button onclick="location.reload()">Tekrar Oyna</button>
</div>

<script>
/* ====== TEMEL ====== */
let score=0,lives=3,level=1,running=true;
let speedFactor=1,secret=false;

const letters=["Y","I","L","D","I","Z"];
const filled=[],active=[],items=[];

const panel=document.getElementById("panel");
const scoreEl=document.getElementById("score");
const livesEl=document.getElementById("lives");
const levelEl=document.getElementById("level");
const story=document.getElementById("storyLine");
const boxes=document.getElementById("letterBoxes");
const over=document.getElementById("over");
const endText=document.getElementById("endText");

/* Kutular */
letters.forEach(l=>{
  const b=document.createElement("div");
  b.className="box";
  b.dataset.letter=l;
  boxes.appendChild(b);
});

/* Panel kontrol */
let drag=false;
panel.addEventListener("touchstart",()=>drag=true);
window.addEventListener("touchend",()=>drag=false);
window.addEventListener("touchmove",e=>{
  if(!drag) return;
  let x=e.touches[0].clientX-panel.offsetWidth/2;
  x=Math.max(0,Math.min(innerWidth-panel.offsetWidth,x));
  panel.style.left=x+"px";
});

/* Yardƒ±mcƒ±lar */
function updateLives(){livesEl.textContent="‚ù§Ô∏è".repeat(lives)}
function collide(a,b){return !(a.right<b.left||a.left>b.right||a.bottom<b.top||a.top>b.bottom)}

/* Hik√¢ye */
const storyTexts=[
  "Yƒ±ldƒ±z gibi parlƒ±yorsun ‚ú®",
  "Kalbim seni se√ßti üíñ",
  "Her par√ßa sana ait",
  "Bu bir oyun deƒüil‚Ä¶",
  "Bu biziz ‚≠ê"
];
function showStory(){
  story.textContent=storyTexts[(level-1)%storyTexts.length];
  story.classList.add("show");
  setTimeout(()=>story.classList.remove("show"),2000);
}

/* Spawn */
function spawn(type){
  if(!running) return;
  if(type==="letter"){
    const pool=letters.filter(l=>filled.filter(x=>x===l).length<letters.filter(x=>x===l).length&&!active.includes(l));
    if(!pool.length) return;
    const l=pool[Math.floor(Math.random()*pool.length)];
    active.push(l);
    const el=document.createElement("div");
    el.className="item letter";
    el.textContent=l;
    el.letter=l;
    el.y=-40;
    el.x=Math.random()*(innerWidth-40);
    el.style.left=el.x+"px";
    document.body.appendChild(el);
    items.push({el,type});
    return;
  }
  const el=document.createElement("div");
  el.className="item "+type;
  el.y=-60;
  el.x=Math.random()*(innerWidth-40);
  el.speed=(type==="meteor"?3:2)*speedFactor;
  el.style.left=el.x+"px";
  document.body.appendChild(el);
  items.push({el,type});
}

/* Loop */
function loop(){
  if(!running) return;
  const pRect=panel.getBoundingClientRect();
  for(let i=items.length-1;i>=0;i--){
    const o=items[i];
    o.el.y+=(o.el.speed||2);
    o.el.style.top=o.el.y+"px";
    const r=o.el.getBoundingClientRect();

    if(collide(r,pRect)){
      if(o.type==="star") score+=10;
      if(o.type==="heart" && lives<3) lives++;
      if(o.type==="meteor") lives--;
      if(o.type==="letter"){
        filled.push(o.el.letter);
        active.splice(active.indexOf(o.el.letter),1);
        const box=[...boxes.children].find(b=>b.textContent==="");
        if(box){box.textContent=o.el.letter;box.classList.add("filled")}
        if(filled.length===letters.length){
          running=false;
          endText.textContent="YILDIZ ‚≠ê\nKalbim hep sende";
          over.style.display="flex";
          return;
        }
      }
      scoreEl.textContent=score;
      updateLives();
      o.el.remove();
      items.splice(i,1);
      if(lives<=0){
        running=false;
        endText.textContent="Kaybettin";
        over.style.display="flex";
        return;
      }
    }
    if(o.el.y>innerHeight+60){
      if(o.type==="letter") active.splice(active.indexOf(o.el.letter),1);
      o.el.remove();
      items.splice(i,1);
    }
  }
  requestAnimationFrame(loop);
}

/* Level & gizli mod */
setInterval(()=>{
  const newLevel=Math.floor(score/100)+1;
  if(newLevel!==level){
    level=newLevel;
    levelEl.textContent="Level: "+level;
    speedFactor+=0.2;
    showStory();
    if(level===5) secret=true;
  }
},500);

/* Zamanlayƒ±cƒ±lar */
setInterval(()=>spawn("star"),800);
setInterval(()=>spawn("meteor"),1200);
setInterval(()=>spawn("heart"),5000);
setInterval(()=>spawn("letter"),3000);

loop();
</script>
</body>
</html>
