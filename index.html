<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>YILDIZ – Stabil Sürüm</title>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:radial-gradient(circle at top,#2b0b4f,#05010a);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  touch-action:none;
  color:#fff;
}

/* Arka plan yıldızlar */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background-image:
    radial-gradient(1px 1px at 20% 30%,#fff,transparent),
    radial-gradient(1px 1px at 70% 60%,#fff,transparent),
    radial-gradient(1px 1px at 40% 80%,#fff,transparent);
  opacity:.2;
  pointer-events:none;
}

/* HUD */
#hud{
  position:fixed;
  top:14px;
  left:14px;
  font-size:16px;
  z-index:10;
}
#lives{margin-left:8px}

/* Panel */
#panel{
  position:fixed;
  bottom:80px;
  left:50%;
  transform:translateX(-50%);
  width:90px;
  height:14px;
  border-radius:20px;
  background:linear-gradient(90deg,#ff6aa2,#ff2f7a);
  box-shadow:0 0 30px rgba(255,80,180,.9);
  z-index:10;
}

/* Objeler */
.item{
  position:absolute;
  top:-60px;
  pointer-events:none;
}

.star{
  width:18px;height:18px;
  background:radial-gradient(circle,#ffe58a,#ffb300);
  clip-path:polygon(
    50% 0%,61% 35%,98% 35%,68% 57%,79% 91%,
    50% 70%,21% 91%,32% 57%,2% 35%,39% 35%
  );
  box-shadow:0 0 14px gold;
}

.meteor{
  width:18px;height:18px;
  border-radius:50%;
  background:radial-gradient(circle,#bbb,#444);
  box-shadow:0 0 20px rgba(200,200,200,.6);
}

/* Game over */
#over{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.8);
  z-index:20;
  align-items:center;
  justify-content:center;
  flex-direction:column;
}
#over button{
  margin-top:20px;
  padding:12px 28px;
  border:none;
  border-radius:20px;
  background:#ff4d6d;
  color:#fff;
  font-size:18px;
}
</style>
</head>

<body>

<div id="hud">
  Skor: <span id="score">0</span>
  <span id="lives">❤️❤️❤️</span>
</div>

<div id="panel"></div>

<div id="over">
  <div id="endText">Oyun Bitti</div>
  <button onclick="location.reload()">Tekrar Oyna</button>
</div>

<script>
/* ===== DEĞİŞKENLER ===== */
let score=0;
let lives=3;
let running=true;

const panel=document.getElementById("panel");
const scoreEl=document.getElementById("score");
const livesEl=document.getElementById("lives");
const over=document.getElementById("over");
const endText=document.getElementById("endText");

const items=[];

/* ===== PANEL KONTROL ===== */
let dragging=false;
panel.addEventListener("touchstart",()=>dragging=true);
window.addEventListener("touchend",()=>dragging=false);
window.addEventListener("touchmove",e=>{
  if(!dragging) return;
  let x=e.touches[0].clientX-panel.offsetWidth/2;
  x=Math.max(0,Math.min(innerWidth-panel.offsetWidth,x));
  panel.style.left=x+"px";
});

/* ===== YARDIMCI ===== */
function updateLives(){
  livesEl.textContent="❤️".repeat(lives);
}
function collide(a,b){
  return !(a.right<b.left||a.left>b.right||a.bottom<b.top||a.top>b.bottom);
}

/* ===== SPAWN ===== */
function spawn(type){
  if(!running) return;

  const el=document.createElement("div");
  el.className="item "+type;
  el.y=-40;
  el.x=Math.random()*(innerWidth-40);
  el.speed=type==="meteor"?3:2;
  el.style.left=el.x+"px";

  document.body.appendChild(el);
  items.push({el,type});
}

/* ===== OYUN DÖNGÜSÜ ===== */
function loop(){
  if(!running) return;

  const pRect=panel.getBoundingClientRect();

  for(let i=items.length-1;i>=0;i--){
    const o=items[i];
    o.el.y+=o.el.speed;
    o.el.style.top=o.el.y+"px";
    const r=o.el.getBoundingClientRect();

    if(collide(r,pRect)){
      if(o.type==="star"){
        score+=10;
        scoreEl.textContent=score;
      }
      if(o.type==="meteor"){
        lives--;
        updateLives();
        if(lives<=0){
          running=false;
          endText.textContent="Kaybettin";
          over.style.display="flex";
        }
      }
      o.el.remove();
      items.splice(i,1);
      continue;
    }

    if(o.el.y>innerHeight+60){
      o.el.remove();
      items.splice(i,1);
    }
  }

  requestAnimationFrame(loop);
}

/* ===== ZAMANLAYICILAR ===== */
setInterval(()=>spawn("star"),900);
setInterval(()=>spawn("meteor"),1400);

updateLives();
loop();
</script>

</body>
</html>
